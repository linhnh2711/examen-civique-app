@tailwind base;
@tailwind components;
@tailwind utilities;

/* ============================================
   iOS SAFE AREA & VIEWPORT HEIGHT FIXES
   ============================================ */

/*
 * CSS Custom Properties for safe viewport height
 * --vh: Calculated by JS as 1% of actual viewport height (fallback to 1vh)
 * --safe-area-top: iOS notch/Dynamic Island inset
 * --safe-area-bottom: iOS home indicator inset
 */
:root {
  --vh: 1vh;
  --safe-area-top: env(safe-area-inset-top, 0px);
  --safe-area-bottom: env(safe-area-inset-bottom, 0px);
  --safe-area-left: env(safe-area-inset-left, 0px);
  --safe-area-right: env(safe-area-inset-right, 0px);
}

* {
  -webkit-tap-highlight-color: transparent;
  -webkit-touch-callout: none;
}

/*
 * HTML/Body base setup for iOS
 * - min-height uses dvh (dynamic viewport height) which accounts for iOS Safari URL bar
 * - Fallback to 100vh for browsers that don't support dvh
 */
html {
  /* Fallback for older browsers */
  height: 100%;
}

body {
  overscroll-behavior-y: contain;
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
    sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  
  /* Fallback height */
  min-height: 100%;
  min-height: 100vh;
  
  /* Modern browsers: use dvh (dynamic viewport height) */
  min-height: 100dvh;
}

/*
 * iOS Safe Area Padding on #root
 * Applied to the root container instead of body for better compatibility
 * with full-height flex layouts
 */
#root {
  /* Fallback min-height */
  min-height: 100vh;
  
  /* Use dvh for iOS Safari - automatically handles URL bar changes */
  min-height: 100dvh;
  
  /* Fallback to JS-calculated height if dvh not supported */
  min-height: calc(var(--vh, 1vh) * 100);
  
  /* Apply safe area padding */
  padding-top: var(--safe-area-top);
  padding-bottom: var(--safe-area-bottom);
  padding-left: var(--safe-area-left);
  padding-right: var(--safe-area-right);
  
  /* Ensure content fills available space */
  display: flex;
  flex-direction: column;
}

/*
 * Override Tailwind's min-h-screen for iOS compatibility
 * min-h-screen uses 100vh which is broken on iOS Safari
 * This makes it use dvh instead, with vh fallback
 */
@layer utilities {
  .min-h-screen {
    min-height: 100vh; /* Fallback */
    min-height: 100dvh; /* iOS Safari fix */
  }
  
  .h-screen {
    height: 100vh; /* Fallback */
    height: 100dvh; /* iOS Safari fix */
  }
  
  /* Safe area aware padding utilities */
  .pt-safe {
    padding-top: var(--safe-area-top);
  }
  
  .pb-safe {
    padding-bottom: var(--safe-area-bottom);
  }
  
  .pl-safe {
    padding-left: var(--safe-area-left);
  }
  
  .pr-safe {
    padding-right: var(--safe-area-right);
  }
  
  .p-safe {
    padding-top: var(--safe-area-top);
    padding-bottom: var(--safe-area-bottom);
    padding-left: var(--safe-area-left);
    padding-right: var(--safe-area-right);
  }
  
  /* Margin utilities for safe areas */
  .mt-safe {
    margin-top: var(--safe-area-top);
  }
  
  .mb-safe {
    margin-bottom: var(--safe-area-bottom);
  }
}

/*
 * iOS-specific fixes using @supports
 * Only applies when the browser supports safe-area-inset-*
 */
@supports (padding: max(0px)) {
  /* Ensure minimum padding even on devices with safe areas */
  #root {
    padding-top: max(0px, env(safe-area-inset-top));
    padding-bottom: max(0px, env(safe-area-inset-bottom));
    padding-left: max(0px, env(safe-area-inset-left));
    padding-right: max(0px, env(safe-area-inset-right));
  }
}

/*
 * Fix for fixed/sticky positioned elements at bottom
 * Ensures buttons and navigation don't get hidden by home indicator
 */
.fixed-bottom-safe {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  padding-bottom: var(--safe-area-bottom);
  padding-left: var(--safe-area-left);
  padding-right: var(--safe-area-right);
}

/* ============================================
   END iOS FIXES
   ============================================ */

/* ============================================
   TOAST ANIMATIONS
   ============================================ */
@keyframes slide-up {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-slide-up {
  animation: slide-up 0.3s ease-out;
}

/* Install prompt removed - not needed for native iOS app */